import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,o as n,d as a}from"./app-CcO3HkfD.js";const i={},l=a(`<h3 id="group-concat" tabindex="-1"><a class="header-anchor" href="#group-concat"><span>group_concat</span></a></h3><ul><li>以id分组，把name字段的值打印在一行，逗号分隔(默认)</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select id,group_concat(name) from aa group by id;  </span></span>
<span class="line"><span></span></span>
<span class="line"><span>+------+--------------------+</span></span>
<span class="line"><span>| id| group_concat(name) |</span></span>
<span class="line"><span>+------+--------------------+</span></span>
<span class="line"><span>|1 | 10,20,20|</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>以id分组，把去冗余的name字段的值打印在一行</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select id,group_concat(distinct name) from aa group by id;   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>+------+-----------------------------+</span></span>
<span class="line"><span>| id| group_concat(distinct name) |</span></span>
<span class="line"><span>+------+-----------------------------+</span></span>
<span class="line"><span>|1 | 10,20|</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>以id分组，把name字段的值打印在一行，逗号分隔，以name排倒序</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select id,group_concat(name order by name desc) from aa group by id;   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>+------+---------------------------------------+</span></span>
<span class="line"><span>| id| group_concat(name order by name desc) |</span></span>
<span class="line"><span>+------+---------------------------------------+</span></span>
<span class="line"><span>|1 | 20,20,10 |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="去重复" tabindex="-1"><a class="header-anchor" href="#去重复"><span>去重复</span></a></h3><p><a href="https://blog.csdn.net/wang1qqqq/article/details/115241993?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-5-115241993-blog-103361459.235%5Ev38%5Epc_relevant_sort_base3&amp;spm=1001.2101.3001.4242.4&amp;utm_relevant_index=8" target="_blank" rel="noopener noreferrer">Mysql去重查询（根据指定字段去重）</a></p><blockquote><p>在日常数据查询中，多有需要进行数据去重的查询，或删除重复数据的情况，以下罗列集中数据去重查询，可根据自身业务场景做调整：</p></blockquote><p>1、根据全部字段的去重查询：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select distinct * from table</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>2、根据某些字段的去重查询（不考虑查询其他字段）</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select distinct c_name,c_year,c_month from table</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select c_name,c_year,c_month from table </span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>3、根据某些字段的去重查询（考虑查询其他字段）</p><p>如果其他字段所有结果值都想保留，建议直接用group by 和group_concat即可</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select c_name,c_year,c_month,group_concat(&#39;,&#39;) c_values from table</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、根据某些字段的去重查询，查询重复项以外的全部数据</p><p>一般去重是根据时间、ID等，如时间最新/ID最大/value最大等等；</p><p>此处示例重复数据中ID小的是原始项，ID大的是重复项；</p><p>如果要看新的数据，则将以下的 min 改为 max ，也可根据自身情况调整其他字段。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select * from tableA</span></span>
<span class="line"><span>where c_id in</span></span>
<span class="line"><span>(select min(c_id) minid from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select * from tableA</span></span>
<span class="line"><span>where c_id not in</span></span>
<span class="line"><span>(select min(c_id) minid from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>having count(*)&gt;1</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、根据某些字段的去重查询，查询重复项（不包含原始项，只查询重复项）</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select * from tableA</span></span>
<span class="line"><span>where c_id not in</span></span>
<span class="line"><span>(select min(c_id) minid from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、根据某些字段，查询出所有重复的数据（包含原始项和重复项）</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select * from tableA a</span></span>
<span class="line"><span>right join</span></span>
<span class="line"><span>(select c_name,c_year,c_month from table A</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>having count(*)&gt;1) b</span></span>
<span class="line"><span>on a.c_name=b.c_name</span></span>
<span class="line"><span>and a.c_year=b.c_year</span></span>
<span class="line"><span>and a.c_month=b.c_month</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7、根据某些字段，删除重复的数据（示例ID最小的是要保留的数据，其他都是不要的）</p><p>从思路上来讲，应该（实际上会出错）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>delete from tableA</span></span>
<span class="line"><span>where c_id not in</span></span>
<span class="line"><span>(select min(c_id) minid from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是此时会报错： You can&#39;t specify target table for update in FROM clause</p><p>原因是：在同一张表，不能先查询某些值，再进行update操作</p><p>解决方法是：需要先把查询处理的id结果，as 一张表，再做delete操作，调整如下：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>delete from tableA</span></span>
<span class="line"><span>where c_id in (</span></span>
<span class="line"><span>select * from</span></span>
<span class="line"><span>(select c_id from tableA</span></span>
<span class="line"><span>where c_id not in</span></span>
<span class="line"><span>(select min(c_id) from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>)) a</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>delete from tableA</span></span>
<span class="line"><span>where c_id in(</span></span>
<span class="line"><span>select * from (</span></span>
<span class="line"><span>select c_id from tableA</span></span>
<span class="line"><span>where c_id in</span></span>
<span class="line"><span>(select max(c_id) from tableA</span></span>
<span class="line"><span>group by c_name,c_year,c_month</span></span>
<span class="line"><span>having count(*)&gt;1</span></span>
<span class="line"><span>)) a</span></span>
<span class="line"><span>)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,39),t=[l];function d(p,c){return n(),e("div",null,t)}const o=s(i,[["render",d],["__file","SQL.html.vue"]]),m=JSON.parse('{"path":"/%E6%8A%80%E6%9C%AF%E8%AE%B0%E5%BD%95/SQL.html","title":"SQL相关","lang":"zh-CN","frontmatter":{"title":"SQL相关","icon":"fab fa-markdown","order":2,"category":["技术记录"],"tag":["技术","随笔"],"date":"2024-05-31T00:00:00.000Z","description":"group_concat 以id分组，把name字段的值打印在一行，逗号分隔(默认) 以id分组，把去冗余的name字段的值打印在一行 以id分组，把name字段的值打印在一行，逗号分隔，以name排倒序 去重复 Mysql去重查询（根据指定字段去重） 在日常数据查询中，多有需要进行数据去重的查询，或删除重复数据的情况，以下罗列集中数据去重查询，可根据...","head":[["meta",{"property":"og:url","content":"https://jijacky.github.io/%E6%8A%80%E6%9C%AF%E8%AE%B0%E5%BD%95/SQL.html"}],["meta",{"property":"og:title","content":"SQL相关"}],["meta",{"property":"og:description","content":"group_concat 以id分组，把name字段的值打印在一行，逗号分隔(默认) 以id分组，把去冗余的name字段的值打印在一行 以id分组，把name字段的值打印在一行，逗号分隔，以name排倒序 去重复 Mysql去重查询（根据指定字段去重） 在日常数据查询中，多有需要进行数据去重的查询，或删除重复数据的情况，以下罗列集中数据去重查询，可根据..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-06T10:05:17.000Z"}],["meta",{"property":"article:author","content":"Veeooo"}],["meta",{"property":"article:tag","content":"技术"}],["meta",{"property":"article:tag","content":"随笔"}],["meta",{"property":"article:published_time","content":"2024-05-31T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-06-06T10:05:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SQL相关\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-05-31T00:00:00.000Z\\",\\"dateModified\\":\\"2024-06-06T10:05:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Veeooo\\",\\"url\\":\\"https://github.com/jijacky\\"}]}"]]},"headers":[{"level":3,"title":"group_concat","slug":"group-concat","link":"#group-concat","children":[]},{"level":3,"title":"去重复","slug":"去重复","link":"#去重复","children":[]}],"git":{"createdTime":1717668317000,"updatedTime":1717668317000,"contributors":[{"name":"jijacky","email":"jijacky@126.com","commits":1}]},"readingTime":{"minutes":2.66,"words":797},"filePathRelative":"技术记录/SQL.md","localizedDate":"2024年5月31日","excerpt":"<h3>group_concat</h3>\\n<ul>\\n<li>以id分组，把name字段的值打印在一行，逗号分隔(默认)</li>\\n</ul>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes github-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>select id,group_concat(name) from aa group by id;  </span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>+------+--------------------+</span></span>\\n<span class=\\"line\\"><span>| id| group_concat(name) |</span></span>\\n<span class=\\"line\\"><span>+------+--------------------+</span></span>\\n<span class=\\"line\\"><span>|1 | 10,20,20|</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{o as comp,m as data};
